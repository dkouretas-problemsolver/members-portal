<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ProblemSolver – Members</title>
  <style>
    body { font-family: Inter, Arial, sans-serif; margin: 0; padding: 40px; background:#fafafa; }
    .card { max-width: 560px; margin: 0 auto; padding: 28px; border: 1px solid #eee; border-radius: 16px; box-shadow: 0 6px 24px rgba(0,0,0,.06); background:#fff; }
    h1 { margin: 16px 0; font-size: 22px; text-align:center; }
    p { color: #444; }
    label { display:block; font-size:14px; margin: 14px 0 6px; }
    input[type="email"], input[type="password"]{ width:100%; padding:12px 14px; border:1px solid #ddd; border-radius:12px; font-size:16px; }
    button{ margin-top:14px; padding:12px 16px; border:0; border-radius:12px; font-size:16px; cursor:pointer; }
    .primary{ background:#FF6B00; color:#fff; }
    .muted{ background:#f3f4f6; }
    .row{ display:flex; gap:20px; align-items:flex-start; justify-content:space-between; margin-top:20px; }
    .col{ flex:1; }
    .chip{ display:inline-block; padding:6px 10px; border-radius:999px; background:#f3f4f6; font-size:12px; text-align:center; }
    .ok{ color:#0f9d58 } 
    .err{ color:#d93025 }
    .hidden{ display:none; }
    .footer{ margin-top:18px; font-size:12px; color:#777; }
    a.btn{ display:inline-block; text-decoration:none; margin-left:10px; }
    img.logo{ max-width:160px; display:block; margin:0 auto 10px; }

    /* Google button */
    .btn-google{
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 14px; border-radius:12px; border:1px solid #ddd;
      background:#fff; color:#222; font-weight:500; cursor:pointer;
    }
    .btn-google:hover{ background:#f7f7f7; }
    .g-icon{ width:18px; height:18px; display:inline-block; }
  </style>
</head>
<body>
  <div class="card">
    <img src="brandmark-design-1080x1080.png" alt="ProblemSolver Logo" class="logo" />
    <h1>ProblemSolver – Members</h1>
    <p id="status" class="chip">Δεν είσαι συνδεδεμένος</p>

    <!-- Google -->
    <div style="text-align:center; margin:20px 0;">
      <button id="googleBtn" class="btn-google">
        <span class="g-icon" aria-hidden="true">
          <svg viewBox="0 0 48 48">
            <path fill="#FFC107" d="M43.611 20.083h-1.611V20H24v8h11.303C33.928 31.91 29.329 35 24 35c-7.18 0-13-5.82-13-13s5.82-13 13-13c3.115 0 5.964 1.108 8.185 2.941l5.657-5.657C34.759 3.174 29.624 1 24 1 11.85 1 2 10.85 2 23s9.85 22 22 22c11.041 0 21-8 21-22 0-1.258-.135-2.477-.389-3.917z"/>
            <path fill="#FF3D00" d="M6.306 14.691l6.571 4.817C14.242 16.33 18.77 13 24 13c3.115 0 5.964 1.108 8.185 2.941l5.657-5.657C34.759 3.174 29.624 1 24 1 15.322 1 7.871 5.937 4.306 13.309l2 1.382z"/>
            <path fill="#4CAF50" d="M24 45c5.24 0 10.003-1.943 13.61-5.17l-6.278-5.318C29.211 36.488 26.77 37 24 37c-5.304 0-9.882-3.07-11.922-7.528l-6.58 5.07C8.994 40.777 15.94 45 24 45z"/>
            <path fill="#1976D2" d="M43.611 20.083H24v8h11.303A12.01 12.01 0 0 1 24 37c-5.304 0-9.882-3.07-11.922-7.528l-6.58 5.07C8.994 40.777 15.94 45 24 45c11.041 0 21-8 21-22 0-1.258-.135-2.477-.389-3.917z"/>
          </svg>
        </span>
        <span>Σύνδεση με Google</span>
      </button>
    </div>

    <hr style="margin:20px 0;"/>

    <!-- Κωδικός & Magic Link δίπλα-δίπλα -->
    <div class="row">
      <!-- Κωδικός -->
      <div class="col">
        <h3>Σύνδεση με Κωδικό</h3>
        <label>Email</label>
        <input id="emailLogin" type="email" placeholder="you@example.com" autocomplete="email" />
        <label>Κωδικός</label>
        <input id="passwordLogin" type="password" placeholder="••••••" autocomplete="current-password" />
        <button id="loginBtn" class="primary">Σύνδεση</button>
        <button id="signupBtn" class="muted">Δημιουργία Λογαριασμού</button>
        <p><a href="/reset.html" class="footer">Ξέχασα τον κωδικό</a></p>
      </div>

      <!-- Magic Link -->
      <div class="col">
        <h3>Σύνδεση με Magic Link</h3>
        <label>Email</label>
        <input id="emailMagic" type="email" placeholder="you@example.com" autocomplete="email" />
        <button id="sendLink" class="primary">Στείλε μου Magic Link</button>
        <p id="msg" class="footer"></p>
      </div>
    </div>
  </div>

  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

    const SUPABASE_URL = 'https://sctqieecpfsaszcuqcrv.supabase.co';
    const SUPABASE_ANON_KEY = '...'; // βάλε το δικό σου anon key
    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const statusEl = document.getElementById('status');
    const msgEl    = document.getElementById('msg');

    async function updateStatus() {
      const { data: { session } } = await supabase.auth.getSession();
      if (session?.user) {
        statusEl.textContent = "Συνδεδεμένος: " + (session.user.email || "");
        statusEl.className = "chip ok";
        window.location.href = "/dashboard.html";
      } else {
        statusEl.textContent = "Δεν είσαι συνδεδεμένος";
        statusEl.className = "chip";
      }
    }

    // Google
    document.getElementById('googleBtn')?.addEventListener('click', async () => {
      await supabase.auth.signInWithOAuth({ provider: 'google' });
    });

    // Magic link
    document.getElementById('sendLink')?.addEventListener('click', async () => {
      msgEl.textContent = '';
      const email = document.getElementById('emailMagic').value.trim();
      const { error } = await supabase.auth.signInWithOtp({ email });
      if (error) { msgEl.textContent = "Σφάλμα: " + error.message; msgEl.className="footer err"; }
      else { msgEl.textContent = "Σου στείλαμε link στο email."; msgEl.className="footer ok"; }
    });

    // Email/Password login
    document.getElementById('loginBtn')?.addEventListener('click', async () => {
      const email = document.getElementById('emailLogin').value.trim();
      const pass  = document.getElementById('passwordLogin').value.trim();
      const { error } = await supabase.auth.signInWithPassword({ email, password:pass });
      if (error) alert("Σφάλμα: " + error.message);
      else updateStatus();
    });

    // Signup
    document.getElementById('signupBtn')?.addEventListener('click', async () => {
      const email = document.getElementById('emailLogin').value.trim();
      const pass  = document.getElementById('passwordLogin').value.trim();
      const { error } = await supabase.auth.signUp({ email, password:pass });
      if (error) alert("Σφάλμα: " + error.message);
      else alert("Έγινε εγγραφή, έλεγξε το email σου.");
    });

    updateStatus();
    supabase.auth.onAuthStateChange(updateStatus);
  </script>
</body>
</html>
